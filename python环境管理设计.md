# Python ç¯å¢ƒç®¡ç† - è®¾è®¡ä¸ä½¿ç”¨è¯´æ˜

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
3. [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
4. [ä½¿ç”¨åœºæ™¯](#ä½¿ç”¨åœºæ™¯)
5. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
6. [è¯¦ç»†åŠŸèƒ½è¯´æ˜](#è¯¦ç»†åŠŸèƒ½è¯´æ˜)
7. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
8. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ç³»ç»Ÿæ¦‚è¿°

Python ç¯å¢ƒç®¡ç†ç³»ç»Ÿæ˜¯ BlockFlow çš„æ ¸å¿ƒç»„ä»¶ï¼Œç”¨äºç®¡ç†å¤šä¸ªç‹¬ç«‹çš„ Python è¿è¡Œç¯å¢ƒï¼Œæ”¯æŒåœ¨çº¿/ç¦»çº¿åŒ…ç®¡ç†ï¼Œä¸ºå—ï¼ˆBlockï¼‰çš„æ‰§è¡Œæä¾›éš”ç¦»çš„ä¾èµ–ç¯å¢ƒã€‚

### æ ¸å¿ƒç‰¹æ€§

- âœ… **å¤šç¯å¢ƒç®¡ç†**ï¼šæ”¯æŒåˆ›å»ºå’Œç®¡ç†å¤šä¸ªç‹¬ç«‹çš„ Python ç¯å¢ƒ
- âœ… **åœ¨çº¿å®‰è£…**ï¼šæ”¯æŒé€šè¿‡ pip åœ¨çº¿å®‰è£… Python åŒ…
- âœ… **ç¦»çº¿å®‰è£…**ï¼šæ”¯æŒä¸Šä¼  `.whl` å’Œ `.tar.gz` æ ¼å¼çš„ç¦»çº¿åŒ…
- âœ… **è¿è¡Œæ—¶ç®¡ç†**ï¼šæ”¯æŒä¸Šä¼ å®Œæ•´çš„ Python è¿è¡Œæ—¶ï¼ˆé€‚ç”¨äºç¦»çº¿ç¯å¢ƒï¼‰
- âœ… **è‡ªåŠ¨æ£€æµ‹**ï¼šè‡ªåŠ¨æ£€æµ‹ Python è§£é‡Šå™¨è·¯å¾„å’Œç‰ˆæœ¬
- âœ… **ä¾èµ–è¿½è¸ª**ï¼šè®°å½•åŒ…çš„å®‰è£…æ–¹å¼ã€ç‰ˆæœ¬å’Œæ¥æº
- âœ… **æ™ºèƒ½æç¤º**ï¼šå—æµ‹è¯•å¤±è´¥æ—¶è‡ªåŠ¨æç¤ºç¼ºå¤±ä¾èµ–å¹¶å¿«é€Ÿè·³è½¬

---

## æ ¸å¿ƒåŠŸèƒ½

### 1. ç¯å¢ƒç®¡ç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Python ç¯å¢ƒåˆ—è¡¨                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ åˆ›å»ºæ–°ç¯å¢ƒ                            â”‚
â”‚  â€¢ ç¼–è¾‘ç¯å¢ƒé…ç½®                          â”‚
â”‚  â€¢ åˆ é™¤ç¯å¢ƒ                              â”‚
â”‚  â€¢ è®¾ç½®é»˜è®¤ç¯å¢ƒ                          â”‚
â”‚  â€¢ å¯¼å‡º requirements.txt                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. è¿è¡Œæ—¶é…ç½®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Python è¿è¡Œæ—¶é…ç½®æ–¹å¼                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ–¹å¼1: æ‰‹åŠ¨é…ç½®è·¯å¾„                     â”‚
â”‚         â””â”€ æŒ‡å®šç³»ç»Ÿå·²å®‰è£…çš„ Python      â”‚
â”‚                                          â”‚
â”‚  æ–¹å¼2: ä¸Šä¼ è¿è¡Œæ—¶åŒ…                     â”‚
â”‚         â””â”€ ä¸Šä¼  .zip/.tar.gz å‹ç¼©åŒ…     â”‚
â”‚         â””â”€ è‡ªåŠ¨è§£å‹å’Œæ£€æµ‹               â”‚
â”‚                                          â”‚
â”‚  æ–¹å¼3: ç¨åé…ç½®                         â”‚
â”‚         â””â”€ åˆ›å»ºåå†é…ç½®                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. åŒ…ç®¡ç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŒ…å®‰è£…æ–¹å¼                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åœ¨çº¿å®‰è£…ï¼ˆéœ€è¦ pipï¼‰                    â”‚
â”‚  â”œâ”€ ä» PyPI å®‰è£…                        â”‚
â”‚  â”œâ”€ æŒ‡å®šç‰ˆæœ¬                            â”‚
â”‚  â””â”€ è‡ªåŠ¨è§£æä¾èµ–                        â”‚
â”‚                                          â”‚
â”‚  ç¦»çº¿å®‰è£…ï¼ˆæ— éœ€ pipï¼‰                    â”‚
â”‚  â”œâ”€ ä¸Šä¼  .whl æ–‡ä»¶                      â”‚
â”‚  â”œâ”€ ä¸Šä¼  .tar.gz æ–‡ä»¶                   â”‚
â”‚  â””â”€ ç›´æ¥è§£å‹åˆ° site-packages           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ¶æ„è®¾è®¡

### 1. æ•°æ®æ¨¡å‹

```java
PythonEnvironment {
    Long id;                           // ç¯å¢ƒID
    String name;                       // ç¯å¢ƒåç§°
    String pythonVersion;              // Pythonç‰ˆæœ¬ï¼ˆå¦‚ï¼š3.9.7ï¼‰
    String description;                // æè¿°
    String pythonExecutable;           // Pythonè§£é‡Šå™¨è·¯å¾„
    String sitePackagesPath;           // site-packagesè·¯å¾„
    String envRootPath;                // ç¯å¢ƒæ ¹ç›®å½•
    Boolean isDefault;                 // æ˜¯å¦ä¸ºé»˜è®¤ç¯å¢ƒ
    Map<String, Object> packages;      // å·²å®‰è£…çš„åŒ…
    Date createTime;                   // åˆ›å»ºæ—¶é—´
}
```

### 2. åŒ…ä¿¡æ¯ç»“æ„

```json
{
  "packages": {
    "requests": {
      "version": "2.28.0",
      "installMethod": "pip",              // pip | offline
      "installedAt": "2025-01-21T10:30:00",
      "installedFrom": null
    },
    "numpy": {
      "version": "1.24.0",
      "installMethod": "offline",
      "installedAt": "2025-01-21T11:00:00",
      "installedFrom": "numpy-1.24.0-cp39-win_amd64.whl"
    }
  }
}
```

### 3. ç›®å½•ç»“æ„

```
block-flow/
â”œâ”€â”€ python-envs/              # Python ç¯å¢ƒæ ¹ç›®å½•
â”‚   â”œâ”€â”€ env-1/               # ç¯å¢ƒ1
â”‚   â”‚   â”œâ”€â”€ python/          # Python è¿è¡Œæ—¶
â”‚   â”‚   â”‚   â”œâ”€â”€ python.exe   # Python è§£é‡Šå™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ Lib/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ site-packages/  # å·²å®‰è£…çš„åŒ…
â”‚   â”‚   â”‚   â””â”€â”€ Scripts/
â”‚   â”‚   â”‚       â””â”€â”€ pip.exe  # pip å·¥å…·
â”‚   â”‚   â””â”€â”€ uploaded/        # ä¸Šä¼ çš„ç¦»çº¿åŒ…
â”‚   â”‚       â”œâ”€â”€ requests-2.28.0.whl
â”‚   â”‚       â””â”€â”€ numpy-1.24.0.whl
â”‚   â”œâ”€â”€ env-2/               # ç¯å¢ƒ2
â”‚   â””â”€â”€ env-3/               # ç¯å¢ƒ3
â””â”€â”€ blocks/                   # å—è„šæœ¬ç›®å½•
```

---

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šåœ¨çº¿ç¯å¢ƒ - ä½¿ç”¨ç³»ç»Ÿ Python

**é€‚ç”¨æƒ…å†µ**ï¼šæœåŠ¡å™¨å·²å®‰è£… Python ä¸”å¯ä»¥è®¿é—®äº’è”ç½‘

```
æ­¥éª¤ï¼š
1. åˆ›å»ºç¯å¢ƒ â†’ é€‰æ‹©"æ‰‹åŠ¨é…ç½®è·¯å¾„"
2. è¾“å…¥ Python è·¯å¾„ï¼š/usr/bin/python3
3. ä¿å­˜ç¯å¢ƒ
4. è¿›å…¥"ç®¡ç†åŒ…" â†’ åœ¨çº¿å®‰è£…ä¾èµ–
```

**ä¼˜ç‚¹**ï¼š
- âœ… é…ç½®ç®€å•
- âœ… å¯ä»¥ä½¿ç”¨ pip åœ¨çº¿å®‰è£…
- âœ… è‡ªåŠ¨è§£æä¾èµ–

**ç¼ºç‚¹**ï¼š
- âŒ éœ€è¦ç½‘ç»œè¿æ¥
- âŒ ä¾èµ–ç³»ç»Ÿ Python

### åœºæ™¯2ï¼šç¦»çº¿ç¯å¢ƒ - ä¸Šä¼  Python è¿è¡Œæ—¶

**é€‚ç”¨æƒ…å†µ**ï¼šæœåŠ¡å™¨æ— æ³•è®¿é—®äº’è”ç½‘ï¼Œéœ€è¦å®Œå…¨ç¦»çº¿éƒ¨ç½²

```
æ­¥éª¤ï¼š
1. åˆ›å»ºç¯å¢ƒ â†’ é€‰æ‹©"ä¸Šä¼ è¿è¡Œæ—¶"
2. ä¸Šä¼  Python å‹ç¼©åŒ…ï¼ˆpython-3.9.7-embed-amd64.zipï¼‰
3. ç³»ç»Ÿè‡ªåŠ¨è§£å‹ã€æ£€æµ‹ Python è·¯å¾„
4. ä¸Šä¼  pip çš„ whl åŒ…ï¼ˆpip-24.0-py3-none-any.whlï¼‰
5. ä¸Šä¼ å…¶ä»–ä¾èµ–çš„ whl åŒ…
```

**ä¼˜ç‚¹**ï¼š
- âœ… å®Œå…¨ç¦»çº¿å¯ç”¨
- âœ… ç¯å¢ƒç‹¬ç«‹éš”ç¦»
- âœ… å¯è¿ç§»æ€§å¼º

**ç¼ºç‚¹**ï¼š
- âŒ éœ€è¦æ‰‹åŠ¨ä¸‹è½½æ‰€æœ‰ä¾èµ–
- âŒ åˆå§‹é…ç½®è¾ƒå¤æ‚

### åœºæ™¯3ï¼šæ··åˆæ¨¡å¼ - åœ¨çº¿ + ç¦»çº¿

**é€‚ç”¨æƒ…å†µ**ï¼šéƒ¨åˆ†åŒ…å¯ä»¥åœ¨çº¿å®‰è£…ï¼Œéƒ¨åˆ†éœ€è¦ç¦»çº¿å®‰è£…

```
æ­¥éª¤ï¼š
1. åˆ›å»ºç¯å¢ƒ â†’ é…ç½® Python è·¯å¾„
2. å¸¸ç”¨åŒ…é€šè¿‡ pip åœ¨çº¿å®‰è£…
3. ç‰¹æ®ŠåŒ…ï¼ˆå¦‚ binary åŒ…ï¼‰é€šè¿‡ç¦»çº¿ä¸Šä¼ 
```

**ä¼˜ç‚¹**ï¼š
- âœ… çµæ´»æ€§é«˜
- âœ… å……åˆ†åˆ©ç”¨ç½‘ç»œå’Œç¦»çº¿èµ„æº

---

## å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»º Python ç¯å¢ƒ

#### æ–¹å¼ Aï¼šä½¿ç”¨ç³»ç»Ÿ Pythonï¼ˆæ¨èåœ¨çº¿ç¯å¢ƒï¼‰

1. è¿›å…¥ **ç®¡ç†åå°** â†’ **Python ç¯å¢ƒ**
2. ç‚¹å‡» **æ–°å»º Python ç¯å¢ƒ**
3. å¡«å†™åŸºæœ¬ä¿¡æ¯ï¼š
   ```
   ç¯å¢ƒåç§°ï¼špython39-prod
   Python ç‰ˆæœ¬ï¼š3.9.7
   æè¿°ï¼šç”Ÿäº§ç¯å¢ƒ Python 3.9
   ```
4. é€‰æ‹©é…ç½®æ–¹å¼ï¼š**æ‰‹åŠ¨é…ç½®è·¯å¾„**
5. è¾“å…¥ Python è§£é‡Šå™¨è·¯å¾„ï¼š
   - Windows: `C:\Python39\python.exe`
   - Linux: `/usr/bin/python3`
6. ç‚¹å‡» **ä¿å­˜**

#### æ–¹å¼ Bï¼šä¸Šä¼  Python è¿è¡Œæ—¶ï¼ˆæ¨èç¦»çº¿ç¯å¢ƒï¼‰

1. ä¸‹è½½ Python åµŒå…¥å¼ç‰ˆæœ¬ï¼š
   - Windows: https://www.python.org/ftp/python/3.9.7/python-3.9.7-embed-amd64.zip
   - æˆ–ä½¿ç”¨æ·˜å®é•œåƒ: https://registry.npmmirror.com/binary.html?path=python/3.9.7/
2. åˆ›å»ºç¯å¢ƒæ—¶é€‰æ‹©ï¼š**ä¸Šä¼ è¿è¡Œæ—¶**
3. é€‰æ‹©ä¸‹è½½çš„ zip æ–‡ä»¶ä¸Šä¼ 
4. ç³»ç»Ÿè‡ªåŠ¨è§£å‹å¹¶é…ç½®

### ç¬¬äºŒæ­¥ï¼šå®‰è£…ä¾èµ–åŒ…

#### åœ¨çº¿å®‰è£…ï¼ˆéœ€è¦ pipï¼‰

1. ç‚¹å‡»ç¯å¢ƒçš„ **ç®¡ç†åŒ…** æŒ‰é’®
2. åœ¨"å®‰è£…æ–°åŒ…"åŒºåŸŸè¾“å…¥ï¼š
   ```
   åŒ…åï¼šrequests
   ç‰ˆæœ¬ï¼š2.28.0ï¼ˆå¯é€‰ï¼Œç•™ç©ºå®‰è£…æœ€æ–°ç‰ˆï¼‰
   ```
3. ç‚¹å‡» **å®‰è£…**
4. æŸ¥çœ‹å®‰è£…æ—¥å¿—ï¼Œç­‰å¾…å®Œæˆ

#### ç¦»çº¿å®‰è£…ï¼ˆæ— éœ€ pipï¼‰

1. ä¸‹è½½æ‰€éœ€çš„ whl åŒ…ï¼š
   - PyPI: https://pypi.org/project/requests/#files
   - æ¸…åé•œåƒ: https://pypi.tuna.tsinghua.edu.cn/simple/requests/
2. ç‚¹å‡»ç¯å¢ƒçš„ **é…ç½®/ç¦»çº¿åŒ…** æŒ‰é’®
3. ç‚¹å‡» **é€‰æ‹©æ–‡ä»¶ä¸Šä¼ å¹¶å®‰è£…**
4. é€‰æ‹©ä¸‹è½½çš„ `.whl` æˆ– `.tar.gz` æ–‡ä»¶
5. ç­‰å¾…ä¸Šä¼ å’Œå®‰è£…å®Œæˆ

### ç¬¬ä¸‰æ­¥ï¼šåœ¨å—ä¸­ä½¿ç”¨ç¯å¢ƒ

1. åˆ›å»ºæˆ–ç¼–è¾‘å—
2. åœ¨å—é…ç½®ä¸­é€‰æ‹© **Python ç¯å¢ƒ**ï¼š
   ```
   Python ç¯å¢ƒ: python39-prod
   ```
3. åœ¨è„šæœ¬ä¸­å¼•å…¥å·²å®‰è£…çš„åŒ…ï¼š
   ```python
   import requests

   url = inputs.get('url', 'https://api.example.com')
   response = requests.get(url)

   outputs = {
       "status_code": response.status_code,
       "data": response.json()
   }
   ```

---

## è¯¦ç»†åŠŸèƒ½è¯´æ˜

### 1. ç¯å¢ƒåˆ—è¡¨ç®¡ç†

#### åŠŸèƒ½æŒ‰é’®è¯´æ˜

| æŒ‰é’® | å›¾æ ‡ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|------|
| è®¾ä¸ºé»˜è®¤ | â­ | è®¾ç½®é»˜è®¤ç¯å¢ƒ | æ–°å»ºå—æ—¶è‡ªåŠ¨é€‰æ‹©æ­¤ç¯å¢ƒ |
| ç®¡ç†åŒ… | âš¡ | åœ¨çº¿åŒ…ç®¡ç† | æ‰“å¼€åœ¨çº¿å®‰è£…/å¸è½½åŒ…çš„å¼¹çª— |
| é…ç½®/ç¦»çº¿åŒ… | ğŸ“¤ | è¿è¡Œæ—¶å’Œç¦»çº¿åŒ…ç®¡ç† | ä¸Šä¼  Python è¿è¡Œæ—¶å’Œç¦»çº¿åŒ… |
| å¯¼å‡º | ğŸ“¥ | å¯¼å‡º requirements.txt | å¯¼å‡ºå·²å®‰è£…åŒ…åˆ—è¡¨ |
| ç¼–è¾‘ | âœï¸ | ç¼–è¾‘ç¯å¢ƒ | ä¿®æ”¹ç¯å¢ƒåç§°ã€æè¿°ç­‰ |
| åˆ é™¤ | ğŸ—‘ï¸ | åˆ é™¤ç¯å¢ƒ | åˆ é™¤ç¯å¢ƒï¼ˆé»˜è®¤ç¯å¢ƒä¸å¯åˆ é™¤ï¼‰ |

#### ç¯å¢ƒçŠ¶æ€æ ‡è¯†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ python39-prod  [é»˜è®¤] [3ä¸ªåŒ…]        â”‚
â”‚ Pythonç‰ˆæœ¬: 3.9.7                    â”‚
â”‚ æè¿°: ç”Ÿäº§ç¯å¢ƒ                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ çŠ¶æ€æŒ‡ç¤º:                             â”‚
â”‚ â€¢ ğŸŸ¢ å·²é…ç½®è¿è¡Œæ—¶ + æœ‰ pip           â”‚
â”‚ â€¢ ğŸŸ¡ å·²é…ç½®è¿è¡Œæ—¶ + æ—  pip           â”‚
â”‚ â€¢ ğŸ”´ æœªé…ç½®è¿è¡Œæ—¶ï¼ˆå¿…é¡»é…ç½®ï¼‰         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. è¿è¡Œæ—¶é…ç½®è¯¦è§£

#### ä¸Šä¼  Python è¿è¡Œæ—¶

**æ”¯æŒçš„æ–‡ä»¶æ ¼å¼**ï¼š
- `.zip` - ZIP å‹ç¼©åŒ…
- `.tar.gz` - GZip å‹ç¼©çš„ TAR å½’æ¡£
- `.tgz` - GZip å‹ç¼©çš„ TAR å½’æ¡£

**æ–‡ä»¶å¤§å°é™åˆ¶**ï¼šæœ€å¤§ 2GB

**è‡ªåŠ¨æ£€æµ‹é¡¹ç›®**ï¼š
1. âœ… Python è§£é‡Šå™¨è·¯å¾„
2. âœ… Python ç‰ˆæœ¬
3. âœ… site-packages è·¯å¾„
4. âœ… pip æ˜¯å¦å¯ç”¨

**æ£€æµ‹ç»“æœç¤ºä¾‹**ï¼š
```
âœ“ Pythonè¿è¡Œæ—¶é…ç½®æˆåŠŸ

Pythonè·¯å¾„: C:\...\python-envs\env-1\python\python.exe
Pythonç‰ˆæœ¬: 3.9.7
site-packages: C:\...\python-envs\env-1\python\Lib\site-packages
pipçŠ¶æ€: âœ“ å·²å®‰è£…
```

#### æ‰‹åŠ¨é…ç½®è·¯å¾„

é€‚ç”¨äºä½¿ç”¨ç³»ç»Ÿå·²å®‰è£…çš„ Pythonï¼š

```
Windows å¸¸è§è·¯å¾„ï¼š
  C:\Python39\python.exe
  C:\Users\<ç”¨æˆ·å>\AppData\Local\Programs\Python\Python39\python.exe

Linux å¸¸è§è·¯å¾„ï¼š
  /usr/bin/python3
  /usr/local/bin/python3
  ~/anaconda3/bin/python

macOS å¸¸è§è·¯å¾„ï¼š
  /usr/bin/python3
  /usr/local/bin/python3
  /Library/Frameworks/Python.framework/Versions/3.9/bin/python3
```

#### è‡ªåŠ¨æ£€æµ‹

ç³»ç»Ÿä¼šå°è¯•åœ¨å·²ä¸Šä¼ çš„è¿è¡Œæ—¶ç›®å½•ä¸­è‡ªåŠ¨æŸ¥æ‰¾ï¼š
- `python.exe`ï¼ˆWindowsï¼‰
- `python`ã€`python3`ï¼ˆLinux/macOSï¼‰

### 3. åŒ…ç®¡ç†è¯¦è§£

#### åœ¨çº¿å®‰è£…æµç¨‹

```mermaid
graph LR
    A[è¾“å…¥åŒ…å] --> B[å¯é€‰:æŒ‡å®šç‰ˆæœ¬]
    B --> C[ç‚¹å‡»å®‰è£…]
    C --> D{ç¯å¢ƒæ£€æŸ¥}
    D -->|æœ‰pip| E[æ‰§è¡Œpip install]
    D -->|æ— pip| F[æç¤ºä¸Šä¼ pipåŒ…]
    E --> G[æ›´æ–°åŒ…åˆ—è¡¨]
    G --> H[æ˜¾ç¤ºå®‰è£…æ—¥å¿—]
```

**å®‰è£…å‘½ä»¤**ï¼š
```bash
python -m pip install <package>==<version>
```

**æ—¥å¿—ç¤ºä¾‹**ï¼š
```
å¼€å§‹åœ¨çº¿å®‰è£… requests==2.28.0...
æ‰§è¡Œå‘½ä»¤: python -m pip install requests==2.28.0
Collecting requests...
æ­£åœ¨è§£æä¾èµ–å…³ç³»...
æ­£åœ¨ä¸‹è½½åŒ…...
æ­£åœ¨å®‰è£…...
âœ“ Successfully installed requests
âœ“ åŒ… requests å®‰è£…æˆåŠŸï¼
```

#### ç¦»çº¿å®‰è£…æµç¨‹

```mermaid
graph LR
    A[é€‰æ‹©.whl/.tar.gz] --> B[ä¸Šä¼ æ–‡ä»¶]
    B --> C[è§£å‹åˆ°site-packages]
    C --> D[æ›´æ–°åŒ…åˆ—è¡¨]
    D --> E{æ˜¯pipåŒ…?}
    E -->|æ˜¯| F[é…ç½®._pthæ–‡ä»¶]
    E -->|å¦| G[å®Œæˆ]
    F --> G
```

**æ”¯æŒçš„åŒ…æ ¼å¼**ï¼š
1. **Wheel åŒ…ï¼ˆ.whlï¼‰**ï¼šæ¨èæ ¼å¼ï¼Œå³è£…å³ç”¨
   ```
   ç¤ºä¾‹: requests-2.28.0-py3-none-any.whl
   ```

2. **æºä»£ç åŒ…ï¼ˆ.tar.gzï¼‰**ï¼šéœ€è¦è§£å‹
   ```
   ç¤ºä¾‹: requests-2.28.0.tar.gz
   ```

**å‘½åè§„åˆ™è¯†åˆ«**ï¼š
```
requests-2.28.0-py3-none-any.whl
  â†“         â†“      â†“    â†“    â†“
åŒ…å     ç‰ˆæœ¬  Pythonç‰ˆæœ¬ ç³»ç»Ÿ æ¶æ„

numpy-1.24.0-cp39-cp39-win_amd64.whl
  â†“      â†“      â†“    â†“      â†“
åŒ…å  ç‰ˆæœ¬  CPython3.9  Windows AMD64
```

#### åŒ…å†²çªæ£€æµ‹

ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹åŒ…æ˜¯å¦å·²å®‰è£…ï¼š

```
æƒ…å†µ1: åŒ…å·²å­˜åœ¨ï¼ˆåœ¨çº¿å®‰è£…ï¼‰
  â†’ å¼¹å‡ºç¡®è®¤å¯¹è¯æ¡†
  â†’ æ˜¾ç¤ºå½“å‰ç‰ˆæœ¬ vs è¯·æ±‚ç‰ˆæœ¬
  â†’ å…è®¸ç”¨æˆ·é€‰æ‹©æ˜¯å¦ç»§ç»­

æƒ…å†µ2: åŒ…å·²å­˜åœ¨ï¼ˆç¦»çº¿ä¸Šä¼ ï¼‰
  â†’ é˜»æ­¢ä¸Šä¼ 
  â†’ æç¤ºå…ˆå¸è½½ç°æœ‰åŒ…
  â†’ ç„¶åå†ä¸Šä¼ æ–°ç‰ˆæœ¬
```

#### å¸è½½åŒ…

```
åœ¨çº¿å®‰è£…çš„åŒ…:
  â€¢ å¸è½½åŒ…
  â€¢ ä¸åˆ é™¤ç¦»çº¿åŒ…æ–‡ä»¶

ç¦»çº¿å®‰è£…çš„åŒ…:
  â€¢ å¸è½½åŒ…
  â€¢ åŒæ—¶åˆ é™¤ç¦»çº¿åŒ…æ–‡ä»¶
```

### 4. ç‰¹æ®ŠåŠŸèƒ½ï¼špip åŒ…ç®¡ç†

#### ä¸ºä»€ä¹ˆéœ€è¦ pipï¼Ÿ

```
æœ‰ pip:
  âœ“ å¯ä»¥åœ¨çº¿å®‰è£…ä»»ä½•åŒ…
  âœ“ è‡ªåŠ¨è§£æä¾èµ–
  âœ“ ä¸‹è½½æœ€æ–°ç‰ˆæœ¬

æ—  pip:
  âœ— åªèƒ½ç¦»çº¿ä¸Šä¼ 
  âœ— æ‰‹åŠ¨ç®¡ç†ä¾èµ–
  âœ— éœ€è¦é¢„å…ˆä¸‹è½½
```

#### å¦‚ä½•æ·»åŠ  pipï¼Ÿ

1. **ä¸‹è½½ pip çš„ whl åŒ…**ï¼š
   - PyPI: https://pypi.org/project/pip/#files
   - æ¨è: `pip-24.0-py3-none-any.whl`ï¼ˆé€šç”¨ç‰ˆæœ¬ï¼‰

2. **ä¸Šä¼  pip åŒ…**ï¼š
   - è¿›å…¥ **é…ç½®/ç¦»çº¿åŒ…** â†’ ä¸Šä¼  pip çš„ whl æ–‡ä»¶
   - ç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«è¿™æ˜¯ pip åŒ…
   - è‡ªåŠ¨é…ç½® Python æ¨¡å—æœç´¢è·¯å¾„

3. **éªŒè¯**ï¼š
   - ä¸Šä¼ æˆåŠŸåï¼Œç¯å¢ƒçŠ¶æ€å˜ä¸º "âœ“ å·²å®‰è£… pip"
   - å¯ä»¥ä½¿ç”¨åœ¨çº¿å®‰è£…åŠŸèƒ½

#### pip é…ç½®åŸç†ï¼ˆWindows embeddableï¼‰

ç³»ç»Ÿä¼šè‡ªåŠ¨ä¿®æ”¹ `python39._pth` æ–‡ä»¶ï¼š

```python
# åŸå§‹å†…å®¹
python39.zip
.

# ä¿®æ”¹åï¼ˆæ·»åŠ  site-packages è·¯å¾„ï¼‰
python39.zip
.
Lib/site-packages
```

---

## æœ€ä½³å®è·µ

### 1. ç¯å¢ƒå‘½åè§„èŒƒ

```
æ¨èå‘½åæ ¼å¼: <pythonç‰ˆæœ¬>-<ç”¨é€”>

ç¤ºä¾‹:
  python39-prod    # Python 3.9 ç”Ÿäº§ç¯å¢ƒ
  python38-dev     # Python 3.8 å¼€å‘ç¯å¢ƒ
  python311-ml     # Python 3.11 æœºå™¨å­¦ä¹ ç¯å¢ƒ
  python39-web     # Python 3.9 Web çˆ¬è™«ç¯å¢ƒ
```

### 2. åŒ…ç‰ˆæœ¬ç®¡ç†

#### å›ºå®šç‰ˆæœ¬ï¼ˆæ¨èï¼‰

```python
# requirements.txt
requests==2.28.0
numpy==1.24.0
pandas==1.5.3
```

**ä¼˜ç‚¹**ï¼š
- âœ… ç¯å¢ƒå¯å¤ç°
- âœ… é¿å…ç‰ˆæœ¬å†²çª
- âœ… ä¾¿äºè°ƒè¯•

#### æœ€æ–°ç‰ˆæœ¬ï¼ˆä¸æ¨èç”Ÿäº§ç¯å¢ƒï¼‰

```python
# requirements.txt
requests
numpy
pandas
```

**ç¼ºç‚¹**ï¼š
- âŒ ç‰ˆæœ¬ä¸ç¡®å®š
- âŒ å¯èƒ½å¼•å…¥ breaking changes
- âŒ éš¾ä»¥å¤ç°é—®é¢˜

### 3. ç¯å¢ƒéš”ç¦»ç­–ç•¥

```
æ–¹æ¡ˆ1: æŒ‰ä¸šåŠ¡ç±»å‹éš”ç¦»
  â”œâ”€â”€ web-scraping-env    # Web çˆ¬è™«ç›¸å…³
  â”œâ”€â”€ data-analysis-env   # æ•°æ®åˆ†æç›¸å…³
  â”œâ”€â”€ ml-env              # æœºå™¨å­¦ä¹ ç›¸å…³
  â””â”€â”€ api-env             # API è°ƒç”¨ç›¸å…³

æ–¹æ¡ˆ2: æŒ‰ Python ç‰ˆæœ¬éš”ç¦»
  â”œâ”€â”€ python38-env        # Python 3.8
  â”œâ”€â”€ python39-env        # Python 3.9
  â””â”€â”€ python311-env       # Python 3.11

æ–¹æ¡ˆ3: æŒ‰ç¯å¢ƒç±»å‹éš”ç¦»
  â”œâ”€â”€ dev-env             # å¼€å‘ç¯å¢ƒ
  â”œâ”€â”€ test-env            # æµ‹è¯•ç¯å¢ƒ
  â””â”€â”€ prod-env            # ç”Ÿäº§ç¯å¢ƒ
```

### 4. ç¦»çº¿åŒ…å‡†å¤‡æ¸…å•

```bash
# 1. ä¸‹è½½ Python è¿è¡Œæ—¶
python-3.9.7-embed-amd64.zip  # Windows
# æˆ–
python-3.9.7-linux-x86_64.tar.gz  # Linux

# 2. ä¸‹è½½ pip
pip-24.0-py3-none-any.whl

# 3. ä¸‹è½½å¸¸ç”¨åŸºç¡€åŒ…
setuptools-65.5.0-py3-none-any.whl
wheel-0.38.4-py3-none-any.whl

# 4. ä¸‹è½½é¡¹ç›®ä¾èµ–ï¼ˆç¤ºä¾‹ï¼‰
requests-2.28.0-py3-none-any.whl
certifi-2022.12.7-py3-none-any.whl
charset-normalizer-2.1.1-py3-none-any.whl
idna-3.4-py3-none-any.whl
urllib3-1.26.13-py2.py3-none-any.whl
```

### 5. å¸¸ç”¨ä¸‹è½½æº

#### å›½å†…é•œåƒï¼ˆæ¨èï¼‰

```
æ¸…åå¤§å­¦é•œåƒ:
  https://pypi.tuna.tsinghua.edu.cn/simple/

é˜¿é‡Œäº‘é•œåƒ:
  https://mirrors.aliyun.com/pypi/simple/

æ·˜å®é•œåƒï¼ˆPython è¿è¡Œæ—¶ï¼‰:
  https://registry.npmmirror.com/binary.html?path=python/
```

#### å®˜æ–¹æº

```
PyPI:
  https://pypi.org/

Python å®˜æ–¹ FTP:
  https://www.python.org/ftp/python/
```

---

## å¸¸è§é—®é¢˜

### Q1: ä¸Šä¼  Python è¿è¡Œæ—¶åæ— æ³•æ£€æµ‹åˆ° pipï¼Ÿ

**åŸå› **ï¼š
- Python embeddable ç‰ˆæœ¬é»˜è®¤ä¸åŒ…å« pip
- éœ€è¦æ‰‹åŠ¨ä¸Šä¼  pip çš„ whl åŒ…

**è§£å†³æ–¹æ¡ˆ**ï¼š
```
1. ä¸‹è½½ pip-24.0-py3-none-any.whl
2. è¿›å…¥"é…ç½®/ç¦»çº¿åŒ…" â†’ ä¸Šä¼  pip åŒ…
3. ç³»ç»Ÿä¼šè‡ªåŠ¨é…ç½® site-packages è·¯å¾„
4. åˆ·æ–°é¡µé¢ï¼Œpip çŠ¶æ€å˜ä¸º"å·²å®‰è£…"
```

### Q2: ç¦»çº¿ä¸Šä¼ åŒ…åï¼Œimport æ—¶æ‰¾ä¸åˆ°æ¨¡å—ï¼Ÿ

**å¯èƒ½åŸå› **ï¼š
1. åŒ…çš„ Python ç‰ˆæœ¬ä¸åŒ¹é…
2. åŒ…çš„å¹³å°ä¸åŒ¹é…ï¼ˆWindows/Linuxï¼‰
3. åŒ…ä¾èµ–å…¶ä»–åŒ…

**è§£å†³æ–¹æ¡ˆ**ï¼š
```
1. æ£€æŸ¥åŒ…çš„å‘½åï¼š
   numpy-1.24.0-cp39-cp39-win_amd64.whl
   â†‘ å¿…é¡»åŒ¹é…ï¼šcp39 = Python 3.9
   â†‘ å¿…é¡»åŒ¹é…ï¼šwin_amd64 = Windows 64ä½

2. æŸ¥çœ‹åŒ…ä¾èµ–ï¼š
   pip show <package>  # åœ¨æœ¬åœ°æ‰§è¡Œ

3. ä¸Šä¼ æ‰€æœ‰ä¾èµ–åŒ…
```

### Q3: åœ¨çº¿å®‰è£…æ—¶æç¤º"è¯¥ç¯å¢ƒæœªé…ç½®Pythonè§£é‡Šå™¨è·¯å¾„"ï¼Ÿ

**åŸå› **ï¼š
- ç¯å¢ƒçš„ `pythonExecutable` å­—æ®µä¸ºç©º
- éœ€è¦å…ˆé…ç½® Python è¿è¡Œæ—¶

**è§£å†³æ–¹æ¡ˆ**ï¼š
```
1. ç‚¹å‡»"é…ç½®/ç¦»çº¿åŒ…"æŒ‰é’®
2. é€‰æ‹©ä»¥ä¸‹æ–¹å¼ä¹‹ä¸€ï¼š
   â€¢ ä¸Šä¼  Python è¿è¡Œæ—¶
   â€¢ è‡ªåŠ¨æ£€æµ‹ Python è·¯å¾„
3. é…ç½®å®Œæˆåï¼Œå³å¯ä½¿ç”¨åœ¨çº¿å®‰è£…
```

### Q4: ä¸ºä»€ä¹ˆ"ç®¡ç†åŒ…"å’Œ"é…ç½®/ç¦»çº¿åŒ…"æ˜¯ä¸¤ä¸ªä¸åŒçš„å¼¹çª—ï¼Ÿ

**è®¾è®¡ç†ç”±**ï¼š
```
ç®¡ç†åŒ…ï¼ˆåœ¨çº¿å®‰è£…ï¼‰:
  â€¢ è½»é‡çº§æ“ä½œ
  â€¢ å¿«é€Ÿå®‰è£…/å¸è½½
  â€¢ éœ€è¦ pip å’Œç½‘ç»œ

é…ç½®/ç¦»çº¿åŒ…ï¼ˆè¿è¡Œæ—¶é…ç½®ï¼‰:
  â€¢ é‡é‡çº§æ“ä½œ
  â€¢ é…ç½® Python è¿è¡Œæ—¶
  â€¢ ä¸Šä¼ å¤§æ–‡ä»¶
  â€¢ å®Œå…¨ç¦»çº¿
```

### Q5: å¦‚ä½•æ‰¹é‡å¯¼å…¥ä¾èµ–ï¼Ÿ

**ä½¿ç”¨ requirements.txt**ï¼š

```
1. å‡†å¤‡ requirements.txt:
   requests==2.28.0
   numpy==1.24.0
   pandas==1.5.3

2. è¿›å…¥"ç®¡ç†åŒ…" â†’ ç‚¹å‡»"å¯¼å…¥ requirements.txt"

3. ç²˜è´´å†…å®¹ â†’ ç‚¹å‡»ç¡®è®¤

4. ç³»ç»Ÿä¼šé€ä¸ªå®‰è£…æ‰€æœ‰åŒ…
```

### Q6: é»˜è®¤ç¯å¢ƒæœ‰ä»€ä¹ˆç”¨ï¼Ÿ

**ä½œç”¨**ï¼š
```
â€¢ æ–°å»ºå—æ—¶è‡ªåŠ¨é€‰æ‹©é»˜è®¤ç¯å¢ƒ
â€¢ ç®€åŒ–æ“ä½œæµç¨‹
â€¢ æ¨èè®¾ç½®ï¼šç”Ÿäº§ç¯å¢ƒçš„ç¨³å®šç‰ˆæœ¬
```

**æ³¨æ„**ï¼š
```
â€¢ é»˜è®¤ç¯å¢ƒä¸èƒ½åˆ é™¤
â€¢ å¯ä»¥æ›´æ¢é»˜è®¤ç¯å¢ƒï¼ˆè®¾ç½®å…¶ä»–ç¯å¢ƒä¸ºé»˜è®¤ï¼‰
```

### Q7: å—æµ‹è¯•æ—¶æç¤º"ModuleNotFoundError"æ€ä¹ˆåŠï¼Ÿ

**è‡ªåŠ¨è·³è½¬åŠŸèƒ½**ï¼š

```
1. æµ‹è¯•å¤±è´¥æ—¶ï¼Œé”™è¯¯ä¿¡æ¯ä¼šæ˜¾ç¤ºï¼š
   "ModuleNotFoundError: No module named 'requests'"

2. è‡ªåŠ¨æç¤ºï¼š
   "ğŸ’¡ è§£å†³å»ºè®®ï¼šè¯¥åŒ…æœªå®‰è£…åœ¨Pythonç¯å¢ƒä¸­"
   "1. åœ¨çº¿å®‰è£…: pip install requests"
   "2. ç¦»çº¿å®‰è£…: ä¸‹è½½ requests çš„ whl åŒ…å¹¶ä¸Šä¼ "

3. ç‚¹å‡»"å‰å¾€Pythonç¯å¢ƒç®¡ç†"æŒ‰é’®
   â†’ è‡ªåŠ¨æ‰“å¼€å¯¹åº”ç¯å¢ƒçš„"ç®¡ç†åŒ…"å¼¹çª—
   â†’ å¯ä»¥ç«‹å³åœ¨çº¿å®‰è£…ç¼ºå¤±çš„åŒ…
```

### Q8: å¦‚ä½•é€‰æ‹© Python ç‰ˆæœ¬ï¼Ÿ

**æ¨èç‰ˆæœ¬**ï¼š
```
ç”Ÿäº§ç¯å¢ƒæ¨è:
  Python 3.9.x  # ç¨³å®šã€å¹¿æ³›æ”¯æŒ

å¼€å‘ç¯å¢ƒå¯é€‰:
  Python 3.10.x # æ–°ç‰¹æ€§
  Python 3.11.x # æ€§èƒ½æå‡
  Python 3.12.x # æœ€æ–°ç‰ˆæœ¬

ä¸æ¨è:
  Python 2.7.x  # å·²åœæ­¢ç»´æŠ¤
  Python 3.7.x  # å³å°†åœæ­¢ç»´æŠ¤
```

### Q9: ç¦»çº¿ç¯å¢ƒå¦‚ä½•å‡†å¤‡æ‰€æœ‰ä¾èµ–ï¼Ÿ

**å®Œæ•´æµç¨‹**ï¼š

```bash
# åœ¨æœ‰ç½‘ç»œçš„æœºå™¨ä¸Šæ‰§è¡Œ

# 1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv test_env
source test_env/bin/activate  # Linux/Mac
# æˆ–
test_env\Scripts\activate  # Windows

# 2. å®‰è£…é¡¹ç›®ä¾èµ–
pip install -r requirements.txt

# 3. ä¸‹è½½æ‰€æœ‰åŒ…ï¼ˆåŒ…æ‹¬ä¾èµ–ï¼‰
pip download -r requirements.txt -d packages/

# 4. æ‰“åŒ…
tar -czf python-packages.tar.gz packages/

# 5. ä¼ è¾“åˆ°ç¦»çº¿æœåŠ¡å™¨

# 6. åœ¨ BlockFlow ä¸­é€ä¸ªä¸Šä¼  whl æ–‡ä»¶
```

### Q10: å¦‚ä½•è¿ç§»ç¯å¢ƒï¼Ÿ

**æ–¹æ¡ˆ1ï¼šå¯¼å‡º requirements.txt**

```
1. åœ¨æºç¯å¢ƒï¼šç‚¹å‡»"å¯¼å‡º"æŒ‰é’®
   â†’ ä¸‹è½½ requirements.txt

2. åœ¨ç›®æ ‡ç¯å¢ƒï¼š
   â€¢ åˆ›å»ºæ–°ç¯å¢ƒ
   â€¢ å¯¼å…¥ requirements.txt
   â€¢ åœ¨çº¿å®‰è£…æ‰€æœ‰åŒ…
```

**æ–¹æ¡ˆ2ï¼šç¦»çº¿åŒ…è¿ç§»**

```
1. è¿›å…¥æºç¯å¢ƒçš„"é…ç½®/ç¦»çº¿åŒ…"
   â†’ ä¸‹è½½æ‰€æœ‰å·²ä¸Šä¼ çš„åŒ…æ–‡ä»¶

2. åœ¨ç›®æ ‡ç¯å¢ƒï¼š
   â€¢ åˆ›å»ºæ–°ç¯å¢ƒ
   â€¢ ä¸Šä¼ æ‰€æœ‰åŒ…æ–‡ä»¶
```

---

## ç¯å¢ƒéš”ç¦»å®ç°åŸç†

### 1. éš”ç¦»æœºåˆ¶æ¦‚è¿°

BlockFlow çš„ Python ç¯å¢ƒéš”ç¦»é€šè¿‡ä»¥ä¸‹ä¸‰ä¸ªå±‚æ¬¡å®ç°ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å±‚æ¬¡1: ç›®å½•éš”ç¦»                                 â”‚
â”‚  â€¢ æ¯ä¸ªç¯å¢ƒæœ‰ç‹¬ç«‹çš„æ ¹ç›®å½•                       â”‚
â”‚  â€¢ ç‹¬ç«‹çš„ site-packages                         â”‚
â”‚  â€¢ ç‹¬ç«‹çš„åŒ…æ–‡ä»¶å­˜å‚¨                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å±‚æ¬¡2: è¿›ç¨‹éš”ç¦»                                 â”‚
â”‚  â€¢ æ¯æ¬¡æ‰§è¡Œä½¿ç”¨ç‹¬ç«‹çš„ Python è¿›ç¨‹               â”‚
â”‚  â€¢ æŒ‡å®šç¯å¢ƒä¸“å±çš„è§£é‡Šå™¨è·¯å¾„                     â”‚
â”‚  â€¢ ç‹¬ç«‹çš„ç¯å¢ƒå˜é‡                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å±‚æ¬¡3: æ•°æ®éš”ç¦»                                 â”‚
â”‚  â€¢ ç¯å¢ƒå…ƒæ•°æ®ç‹¬ç«‹å­˜å‚¨                           â”‚
â”‚  â€¢ åŒ…åˆ—è¡¨æŒ‰ç¯å¢ƒåˆ†ç»„                             â”‚
â”‚  â€¢ å—ä¸ç¯å¢ƒçš„å…³è”å…³ç³»                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. ç›®å½•éš”ç¦»è¯¦è§£

#### 2.1 ç›®å½•ç»“æ„è®¾è®¡

```
block-flow/
â”œâ”€â”€ python-envs/                     # ç¯å¢ƒæ ¹ç›®å½•
â”‚   â”œâ”€â”€ env-{id}/                   # ç¯å¢ƒç›®å½•ï¼ˆæŒ‰IDéš”ç¦»ï¼‰
â”‚   â”‚   â”œâ”€â”€ python/                 # Python è¿è¡Œæ—¶
â”‚   â”‚   â”‚   â”œâ”€â”€ python.exe          # Python è§£é‡Šå™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ python39.dll        # æ ¸å¿ƒåº“
â”‚   â”‚   â”‚   â”œâ”€â”€ python39._pth       # æ¨¡å—æœç´¢è·¯å¾„é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ python39.zip        # æ ‡å‡†åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ Lib/                # åº“ç›®å½•
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ site-packages/  # ç¬¬ä¸‰æ–¹åŒ…
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ requests/   # å·²å®‰è£…çš„åŒ…
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ numpy/
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚   â”‚   â””â”€â”€ Scripts/            # å¯æ‰§è¡Œè„šæœ¬
â”‚   â”‚   â”‚       â”œâ”€â”€ pip.exe
â”‚   â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚   â””â”€â”€ uploaded/               # ç¦»çº¿åŒ…å­˜å‚¨
â”‚   â”‚       â”œâ”€â”€ requests-2.28.0.whl
â”‚   â”‚       â””â”€â”€ numpy-1.24.0.whl
â”‚   â”‚
â”‚   â”œâ”€â”€ env-{id+1}/                 # å¦ä¸€ä¸ªç¯å¢ƒ
â”‚   â”‚   â”œâ”€â”€ python/
â”‚   â”‚   â””â”€â”€ uploaded/
â”‚   â”‚
â”‚   â””â”€â”€ env-{id+2}/                 # ç¬¬ä¸‰ä¸ªç¯å¢ƒ
â”‚       â”œâ”€â”€ python/
â”‚       â””â”€â”€ uploaded/
â”‚
â””â”€â”€ temp/                            # ä¸´æ—¶æ‰§è¡Œç›®å½•
    â””â”€â”€ block-{id}-{timestamp}/     # å—æ‰§è¡Œçš„ä¸´æ—¶ç›®å½•
        â”œâ”€â”€ script.py               # æ‰§è¡Œè„šæœ¬
        â””â”€â”€ output.json             # æ‰§è¡Œç»“æœ
```

#### 2.2 ç¯å¢ƒåˆå§‹åŒ–æµç¨‹

```java
// PythonEnvironmentServiceImpl.java

@Override
public void initializeEnvironment(Long envId) {
    PythonEnvironment env = repository.findById(envId)
        .orElseThrow(() -> new RuntimeException("ç¯å¢ƒä¸å­˜åœ¨"));

    // 1. åˆ›å»ºç¯å¢ƒæ ¹ç›®å½•
    String envRoot = pythonEnvRootPath + "/env-" + envId;
    Path envPath = Paths.get(envRoot);
    Files.createDirectories(envPath);

    // 2. åˆ›å»ºå­ç›®å½•
    Path pythonPath = envPath.resolve("python");
    Path uploadedPath = envPath.resolve("uploaded");
    Files.createDirectories(pythonPath);
    Files.createDirectories(uploadedPath);

    // 3. æ›´æ–°ç¯å¢ƒé…ç½®
    env.setEnvRootPath(envRoot);
    repository.save(env);
}
```

#### 2.3 site-packages éš”ç¦»

æ¯ä¸ªç¯å¢ƒçš„ `site-packages` ç›®å½•å®Œå…¨ç‹¬ç«‹ï¼š

```
ç¯å¢ƒ1 (env-1):
  site-packages/
    â”œâ”€â”€ requests/         # ç‰ˆæœ¬ 2.28.0
    â””â”€â”€ numpy/            # ç‰ˆæœ¬ 1.24.0

ç¯å¢ƒ2 (env-2):
  site-packages/
    â”œâ”€â”€ requests/         # ç‰ˆæœ¬ 2.31.0 (ä¸åŒç‰ˆæœ¬)
    â””â”€â”€ pandas/           # ä¸åŒçš„åŒ…

ç¯å¢ƒ3 (env-3):
  site-packages/
    â”œâ”€â”€ tensorflow/       # æœºå™¨å­¦ä¹ åŒ…
    â””â”€â”€ scikit-learn/
```

**éš”ç¦»æ•ˆæœ**ï¼š
- âœ… åŒä¸€ä¸ªåŒ…çš„ä¸åŒç‰ˆæœ¬å¯ä»¥å…±å­˜
- âœ… ä¸åŒç¯å¢ƒçš„åŒ…äº’ä¸å½±å“
- âœ… æ¯ä¸ªç¯å¢ƒéƒ½æ˜¯å¹²å‡€çš„ç‹¬ç«‹ç©ºé—´

### 3. è¿›ç¨‹éš”ç¦»è¯¦è§£

#### 3.1 æ‰§è¡Œè„šæœ¬çš„éš”ç¦»æœºåˆ¶

```java
// PythonScriptExecutor.java

public Map<String, Object> executeScript(
    String script,
    Map<String, Object> inputs,
    PythonEnvironment environment
) {
    // 1. è·å–ç¯å¢ƒä¸“å±çš„ Python è§£é‡Šå™¨
    String pythonExecutable = environment.getPythonExecutable();

    // 2. åˆ›å»ºä¸´æ—¶æ‰§è¡Œç›®å½•ï¼ˆæ¯æ¬¡æ‰§è¡Œéƒ½æ˜¯æ–°çš„ï¼‰
    String tempDir = createTempDirectory();
    File scriptFile = new File(tempDir, "script.py");

    // 3. å†™å…¥è„šæœ¬
    Files.writeString(scriptFile.toPath(), script, StandardCharsets.UTF_8);

    // 4. æ„å»ºè¿›ç¨‹å‘½ä»¤
    ProcessBuilder pb = new ProcessBuilder(
        pythonExecutable,      // ä½¿ç”¨æŒ‡å®šç¯å¢ƒçš„ Python
        scriptFile.getAbsolutePath()
    );

    // 5. è®¾ç½®å·¥ä½œç›®å½•ï¼ˆéš”ç¦»ï¼‰
    pb.directory(new File(tempDir));

    // 6. è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆéš”ç¦»ï¼‰
    Map<String, String> env = pb.environment();
    env.put("PYTHONPATH", environment.getSitePackagesPath());
    env.put("PYTHONIOENCODING", "utf-8");

    // 7. å¯åŠ¨ç‹¬ç«‹è¿›ç¨‹
    Process process = pb.start();

    // 8. æ‰§è¡Œå®Œæˆåæ¸…ç†
    cleanupTempDirectory(tempDir);
}
```

#### 3.2 è¿›ç¨‹çº§åˆ«çš„éš”ç¦»ä¿éšœ

```
å—Aæ‰§è¡Œï¼ˆç¯å¢ƒ1ï¼‰:
  â”œâ”€ è¿›ç¨‹ID: 12345
  â”œâ”€ Python: /path/to/env-1/python/python.exe
  â”œâ”€ site-packages: /path/to/env-1/python/Lib/site-packages
  â”œâ”€ å·¥ä½œç›®å½•: /temp/block-1-20250121-120000
  â””â”€ ç¯å¢ƒå˜é‡:
      â€¢ PYTHONPATH=/path/to/env-1/python/Lib/site-packages
      â€¢ PYTHONIOENCODING=utf-8

å—Bæ‰§è¡Œï¼ˆç¯å¢ƒ2ï¼‰:
  â”œâ”€ è¿›ç¨‹ID: 12346 (ä¸åŒçš„è¿›ç¨‹)
  â”œâ”€ Python: /path/to/env-2/python/python.exe (ä¸åŒçš„è§£é‡Šå™¨)
  â”œâ”€ site-packages: /path/to/env-2/python/Lib/site-packages
  â”œâ”€ å·¥ä½œç›®å½•: /temp/block-2-20250121-120001 (ä¸åŒçš„ç›®å½•)
  â””â”€ ç¯å¢ƒå˜é‡:
      â€¢ PYTHONPATH=/path/to/env-2/python/Lib/site-packages
      â€¢ PYTHONIOENCODING=utf-8
```

**éš”ç¦»æ•ˆæœ**ï¼š
- âœ… ä¸åŒå—çš„æ‰§è¡Œäº’ä¸å¹²æ‰°
- âœ… å³ä½¿åŒæ—¶æ‰§è¡Œï¼Œä¹Ÿæ˜¯ç‹¬ç«‹çš„è¿›ç¨‹
- âœ… è¿›ç¨‹å´©æºƒä¸ä¼šå½±å“å…¶ä»–å—
- âœ… å†…å­˜ã€CPU èµ„æºç‹¬ç«‹è®¡ç®—

### 4. æ•°æ®éš”ç¦»è¯¦è§£

#### 4.1 æ•°æ®åº“å±‚é¢çš„éš”ç¦»

```sql
-- ç¯å¢ƒè¡¨ï¼ˆæ¯ä¸ªç¯å¢ƒç‹¬ç«‹ä¸€è¡Œï¼‰
CREATE TABLE python_environment (
    id BIGINT PRIMARY KEY,
    name VARCHAR(255),
    python_executable VARCHAR(500),     -- ç¯å¢ƒä¸“å±çš„è§£é‡Šå™¨è·¯å¾„
    site_packages_path VARCHAR(500),    -- ç¯å¢ƒä¸“å±çš„ site-packages
    env_root_path VARCHAR(500),         -- ç¯å¢ƒæ ¹ç›®å½•
    packages JSON,                      -- ç¯å¢ƒçš„åŒ…åˆ—è¡¨ï¼ˆJSONå­—æ®µï¼‰
    is_default BOOLEAN,
    create_time DATETIME
);

-- å—è¡¨ï¼ˆå…³è”åˆ°ç¯å¢ƒï¼‰
CREATE TABLE block (
    id BIGINT PRIMARY KEY,
    name VARCHAR(255),
    script TEXT,
    python_env_id BIGINT,               -- å…³è”åˆ°å…·ä½“ç¯å¢ƒ
    FOREIGN KEY (python_env_id) REFERENCES python_environment(id)
);
```

#### 4.2 åŒ…åˆ—è¡¨çš„éš”ç¦»å­˜å‚¨

```json
// ç¯å¢ƒ1çš„åŒ…åˆ—è¡¨
{
  "id": 1,
  "name": "python39-prod",
  "packages": {
    "requests": {
      "version": "2.28.0",
      "installMethod": "pip",
      "installedAt": "2025-01-21T10:00:00"
    },
    "numpy": {
      "version": "1.24.0",
      "installMethod": "offline",
      "installedFrom": "numpy-1.24.0.whl"
    }
  }
}

// ç¯å¢ƒ2çš„åŒ…åˆ—è¡¨ï¼ˆå®Œå…¨ç‹¬ç«‹ï¼‰
{
  "id": 2,
  "name": "python39-dev",
  "packages": {
    "requests": {
      "version": "2.31.0",      // ä¸åŒç‰ˆæœ¬
      "installMethod": "pip"
    },
    "pandas": {                 // ä¸åŒçš„åŒ…
      "version": "1.5.3",
      "installMethod": "pip"
    }
  }
}
```

**éš”ç¦»æ•ˆæœ**ï¼š
- âœ… æ¯ä¸ªç¯å¢ƒçš„åŒ…åˆ—è¡¨ç‹¬ç«‹å­˜å‚¨
- âœ… åŒ…çš„å…ƒæ•°æ®äº’ä¸å½±å“
- âœ… å¯ä»¥ç²¾ç¡®è¿½è¸ªæ¯ä¸ªç¯å¢ƒçš„ä¾èµ–

### 5. éš”ç¦»çº§åˆ«å¯¹æ¯”

#### 5.1 ä¸å…¶ä»–éš”ç¦»æ–¹æ¡ˆå¯¹æ¯”

| ç‰¹æ€§ | BlockFlow ç¯å¢ƒéš”ç¦» | Python venv | Docker å®¹å™¨ | Conda ç¯å¢ƒ |
|------|-------------------|-------------|-------------|-----------|
| ç›®å½•éš”ç¦» | âœ… å®Œå…¨éš”ç¦» | âœ… å®Œå…¨éš”ç¦» | âœ… å®Œå…¨éš”ç¦» | âœ… å®Œå…¨éš”ç¦» |
| è¿›ç¨‹éš”ç¦» | âœ… ç‹¬ç«‹è¿›ç¨‹ | âœ… ç‹¬ç«‹è¿›ç¨‹ | âœ… ç‹¬ç«‹å®¹å™¨ | âœ… ç‹¬ç«‹è¿›ç¨‹ |
| Python ç‰ˆæœ¬éš”ç¦» | âœ… æ”¯æŒ | âŒ éœ€è¦æ‰‹åŠ¨ | âœ… æ”¯æŒ | âœ… æ”¯æŒ |
| ç¦»çº¿éƒ¨ç½² | âœ… æ”¯æŒ | âš ï¸ éƒ¨åˆ†æ”¯æŒ | âœ… æ”¯æŒ | âš ï¸ éƒ¨åˆ†æ”¯æŒ |
| GUI ç®¡ç† | âœ… Web ç•Œé¢ | âŒ å‘½ä»¤è¡Œ | âš ï¸ éƒ¨åˆ†æ”¯æŒ | âŒ å‘½ä»¤è¡Œ |
| è½»é‡çº§ | âœ… è½»é‡ | âœ… è½»é‡ | âŒ é‡é‡çº§ | âš ï¸ ä¸­ç­‰ |
| è·¨å¹³å° | âœ… æ”¯æŒ | âœ… æ”¯æŒ | âœ… æ”¯æŒ | âœ… æ”¯æŒ |

#### 5.2 BlockFlow éš”ç¦»çš„ä¼˜åŠ¿

```
ä¼˜åŠ¿1: é›¶å­¦ä¹ æˆæœ¬
  â€¢ ç”¨æˆ·æ— éœ€äº†è§£ venvã€virtualenvã€conda
  â€¢ é€šè¿‡ Web ç•Œé¢å¯è§†åŒ–ç®¡ç†
  â€¢ ä¸€é”®åˆ›å»ºã€ä¸€é”®åˆ‡æ¢

ä¼˜åŠ¿2: å®Œå…¨å¯æ§
  â€¢ æ˜ç¡®çš„ç›®å½•ç»“æ„
  â€¢ æ¸…æ™°çš„ä¾èµ–è¿½è¸ª
  â€¢ å¯è§†åŒ–çš„åŒ…ç®¡ç†

ä¼˜åŠ¿3: ç¦»çº¿å‹å¥½
  â€¢ æ”¯æŒå®Œå…¨ç¦»çº¿éƒ¨ç½²
  â€¢ å¯ä¸Šä¼ å®Œæ•´çš„ Python è¿è¡Œæ—¶
  â€¢ ç¦»çº¿åŒ…ç®¡ç†

ä¼˜åŠ¿4: ç»†ç²’åº¦æ§åˆ¶
  â€¢ å—çº§åˆ«çš„ç¯å¢ƒå…³è”
  â€¢ å¯ä»¥ä¸ºä¸åŒå—é€‰æ‹©ä¸åŒç¯å¢ƒ
  â€¢ ç¯å¢ƒåˆ‡æ¢é›¶æˆæœ¬
```

### 6. éš”ç¦»çš„å®ç°ç»†èŠ‚

#### 6.1 åŒ…å®‰è£…çš„éš”ç¦»

**åœ¨çº¿å®‰è£…ï¼ˆä½¿ç”¨ pipï¼‰**ï¼š

```java
// PythonEnvironmentServiceImpl.java

public void installPackage(Long envId, String packageName, String version) {
    PythonEnvironment env = getById(envId);

    // 1. æ„å»º pip å‘½ä»¤ï¼ŒæŒ‡å®šç›®æ ‡ç¯å¢ƒçš„ Python
    String pythonExe = env.getPythonExecutable();
    String command = String.format(
        "%s -m pip install %s%s --target %s",
        pythonExe,
        packageName,
        version != null ? "==" + version : "",
        env.getSitePackagesPath()  // å®‰è£…åˆ°ç¯å¢ƒä¸“å±ç›®å½•
    );

    // 2. æ‰§è¡Œå®‰è£…
    Process process = Runtime.getRuntime().exec(command);

    // 3. æ›´æ–°ç¯å¢ƒçš„åŒ…åˆ—è¡¨
    updatePackageList(env, packageName, version);
}
```

**ç¦»çº¿å®‰è£…ï¼ˆç›´æ¥è§£å‹ï¼‰**ï¼š

```java
public void uploadAndInstallPackage(Long envId, MultipartFile file) {
    PythonEnvironment env = getById(envId);

    // 1. ä¿å­˜åˆ°ç¯å¢ƒä¸“å±çš„ uploaded ç›®å½•
    String uploadedPath = env.getEnvRootPath() + "/uploaded/" + file.getOriginalFilename();
    file.transferTo(new File(uploadedPath));

    // 2. è§£å‹åˆ°ç¯å¢ƒä¸“å±çš„ site-packages
    String sitePackages = env.getSitePackagesPath();
    if (file.getOriginalFilename().endsWith(".whl")) {
        // Wheel åŒ…è§£å‹
        unzipWheelPackage(uploadedPath, sitePackages);
    } else {
        // tar.gz åŒ…è§£å‹
        extractTarGz(uploadedPath, sitePackages);
    }

    // 3. æ›´æ–°ç¯å¢ƒçš„åŒ…åˆ—è¡¨
    updatePackageList(env, packageName, version);
}
```

#### 6.2 Python è·¯å¾„çš„éš”ç¦»é…ç½®

**Windows embeddable ç‰ˆæœ¬çš„è·¯å¾„é…ç½®**ï¼š

```python
# python39._pth æ–‡ä»¶å†…å®¹
python39.zip
.

# ç³»ç»Ÿä¼šåœ¨ä¸Šä¼  pip åŒ…åè‡ªåŠ¨ä¿®æ”¹ä¸ºï¼š
python39.zip
.
Lib/site-packages           # æ·»åŠ  site-packages è·¯å¾„

# è¿™æ · Python å°±èƒ½æ‰¾åˆ°è¯¥ç¯å¢ƒçš„åŒ…
```

**ç¯å¢ƒå˜é‡é…ç½®**ï¼š

```java
// æ‰§è¡Œè„šæœ¬æ—¶è®¾ç½®ç¯å¢ƒå˜é‡
Map<String, String> env = processBuilder.environment();

// 1. è®¾ç½® PYTHONPATHï¼ˆæŒ‡å‘ç¯å¢ƒçš„ site-packagesï¼‰
env.put("PYTHONPATH", environment.getSitePackagesPath());

// 2. è®¾ç½®ç¼–ç 
env.put("PYTHONIOENCODING", "utf-8");

// 3. æ¸…é™¤å¯èƒ½å¹²æ‰°çš„ç³»ç»Ÿå˜é‡
env.remove("PYTHONHOME");  // é¿å…ä½¿ç”¨ç³»ç»Ÿ Python
```

#### 6.3 æ‰§è¡Œæ—¶çš„ä¸´æ—¶ç›®å½•éš”ç¦»

```java
// æ¯æ¬¡æ‰§è¡Œéƒ½åˆ›å»ºä¸´æ—¶ç›®å½•
private String createTempDirectory() {
    String timestamp = LocalDateTime.now()
        .format(DateTimeFormatter.ofPattern("yyyyMMdd-HHmmss-SSS"));

    String tempDir = tempBasePath + "/block-" + blockId + "-" + timestamp;
    Files.createDirectories(Paths.get(tempDir));

    return tempDir;
}

// æ‰§è¡Œå®Œæˆåæ¸…ç†
private void cleanupTempDirectory(String tempDir) {
    try {
        FileUtils.deleteDirectory(new File(tempDir));
    } catch (IOException e) {
        log.warn("æ¸…ç†ä¸´æ—¶ç›®å½•å¤±è´¥: {}", tempDir);
    }
}
```

**ä¸´æ—¶ç›®å½•çš„ä½œç”¨**ï¼š
```
ä½œç”¨1: é¿å…æ–‡ä»¶å†²çª
  â€¢ å¤šä¸ªå—åŒæ—¶æ‰§è¡Œä¸ä¼šè¦†ç›–æ–‡ä»¶
  â€¢ æ¯æ¬¡æ‰§è¡Œéƒ½æœ‰å¹²å‡€çš„å·¥ä½œç›®å½•

ä½œç”¨2: å®‰å…¨éš”ç¦»
  â€¢ å—æ— æ³•è®¿é—®å…¶ä»–å—çš„æ–‡ä»¶
  â€¢ æ‰§è¡Œå®Œæˆåè‡ªåŠ¨æ¸…ç†

ä½œç”¨3: æ—¥å¿—éš”ç¦»
  â€¢ æ¯æ¬¡æ‰§è¡Œçš„è¾“å‡ºæ–‡ä»¶ç‹¬ç«‹
  â€¢ ä¾¿äºè¿½è¸ªå’Œè°ƒè¯•
```

### 7. éš”ç¦»çš„å®‰å…¨æ€§ä¿éšœ

#### 7.1 æ–‡ä»¶ç³»ç»Ÿéš”ç¦»

```
æƒé™æ§åˆ¶:
  âœ“ æ¯ä¸ªç¯å¢ƒç›®å½•ç‹¬ç«‹
  âœ“ ä¸´æ—¶ç›®å½•éšæœºç”Ÿæˆ
  âœ“ æ‰§è¡Œå®Œæˆåç«‹å³æ¸…ç†
  âœ“ å—è„šæœ¬æ— æ³•è®¿é—®å…¶ä»–ç¯å¢ƒ

è·¯å¾„æ ¡éªŒ:
  âœ“ æ‰€æœ‰æ–‡ä»¶æ“ä½œéƒ½è¿›è¡Œè·¯å¾„éªŒè¯
  âœ“ é˜²æ­¢è·¯å¾„ç©¿è¶Šæ”»å‡»
  âœ“ é™åˆ¶åœ¨ç¯å¢ƒæ ¹ç›®å½•å†…
```

#### 7.2 èµ„æºéš”ç¦»

```java
// è®¾ç½®è¿›ç¨‹è¶…æ—¶
Process process = processBuilder.start();
boolean finished = process.waitFor(60, TimeUnit.SECONDS);

if (!finished) {
    // è¶…æ—¶å¼ºåˆ¶ç»ˆæ­¢
    process.destroyForcibly();
    throw new RuntimeException("è„šæœ¬æ‰§è¡Œè¶…æ—¶");
}

// èµ„æºé™åˆ¶
- æ‰§è¡Œæ—¶é—´ï¼š60ç§’
- è¾“å‡ºå¤§å°ï¼šé™åˆ¶æ—¥å¿—å¤§å°
- ä¸´æ—¶æ–‡ä»¶ï¼šæ‰§è¡Œåè‡ªåŠ¨æ¸…ç†
```

### 8. éš”ç¦»çš„æ€§èƒ½ä¼˜åŒ–

#### 8.1 ç¼“å­˜æœºåˆ¶

```java
// ç¯å¢ƒä¿¡æ¯ç¼“å­˜ï¼ˆé¿å…é‡å¤æŸ¥è¯¢ï¼‰
@Cacheable(value = "python-env", key = "#envId")
public PythonEnvironment getById(Long envId) {
    return repository.findById(envId).orElse(null);
}

// åŒ…åˆ—è¡¨ç¼“å­˜
@Cacheable(value = "env-packages", key = "#envId")
public Map<String, Object> getPackages(Long envId) {
    PythonEnvironment env = getById(envId);
    return env.getPackages();
}
```

#### 8.2 è¿›ç¨‹å¤ç”¨

```java
// å¯¹äºåŒä¸€ç¯å¢ƒçš„å¤šæ¬¡æ‰§è¡Œï¼Œå¯ä»¥ä¼˜åŒ–è¿›ç¨‹å¯åŠ¨
private ProcessBuilder getCachedProcessBuilder(Long envId) {
    return processBuilderCache.computeIfAbsent(envId, id -> {
        PythonEnvironment env = getById(id);
        return new ProcessBuilder(env.getPythonExecutable());
    });
}
```

### 9. éš”ç¦»çš„ç›‘æ§ä¸è°ƒè¯•

#### 9.1 ç¯å¢ƒçŠ¶æ€ç›‘æ§

```json
{
  "envId": 1,
  "name": "python39-prod",
  "status": "active",
  "stats": {
    "totalPackages": 15,
    "diskUsage": "245MB",
    "lastUsed": "2025-01-21T15:30:00",
    "executionCount": 1523
  }
}
```

#### 9.2 æ‰§è¡Œæ—¥å¿—è¿½è¸ª

```
æ‰§è¡Œè®°å½•:
  â€¢ å—ID: 123
  â€¢ ç¯å¢ƒID: 1
  â€¢ ç¯å¢ƒåç§°: python39-prod
  â€¢ Pythonç‰ˆæœ¬: 3.9.7
  â€¢ æ‰§è¡Œæ—¶é—´: 2025-01-21 15:30:00
  â€¢ è€—æ—¶: 1.23ç§’
  â€¢ çŠ¶æ€: æˆåŠŸ
  â€¢ è¾“å‡º: {...}
```

### 10. éš”ç¦»æœºåˆ¶æ€»ç»“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BlockFlow Python ç¯å¢ƒéš”ç¦»å…¨æ™¯å›¾                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  æ•°æ®åº“å±‚                                            â”‚
â”‚  â”œâ”€ ç¯å¢ƒè¡¨ï¼šæ¯ä¸ªç¯å¢ƒç‹¬ç«‹è®°å½•                         â”‚
â”‚  â”œâ”€ å—è¡¨ï¼šå…³è”åˆ°å…·ä½“ç¯å¢ƒ                            â”‚
â”‚  â””â”€ åŒ…åˆ—è¡¨ï¼šJSON å­—æ®µå­˜å‚¨ç¯å¢ƒåŒ…                     â”‚
â”‚                                                      â”‚
â”‚  æ–‡ä»¶ç³»ç»Ÿå±‚                                          â”‚
â”‚  â”œâ”€ ç¯å¢ƒæ ¹ç›®å½•ï¼š/python-envs/env-{id}/              â”‚
â”‚  â”œâ”€ Python è¿è¡Œæ—¶ï¼šç‹¬ç«‹çš„è§£é‡Šå™¨                     â”‚
â”‚  â”œâ”€ site-packagesï¼šç‹¬ç«‹çš„åŒ…ç›®å½•                     â”‚
â”‚  â””â”€ ä¸´æ—¶ç›®å½•ï¼šæ¯æ¬¡æ‰§è¡Œç‹¬ç«‹                          â”‚
â”‚                                                      â”‚
â”‚  è¿›ç¨‹å±‚                                              â”‚
â”‚  â”œâ”€ ç‹¬ç«‹è¿›ç¨‹ï¼šæ¯æ¬¡æ‰§è¡Œå¯åŠ¨æ–°è¿›ç¨‹                    â”‚
â”‚  â”œâ”€ ç¯å¢ƒå˜é‡ï¼šPYTHONPATH æŒ‡å‘ç¯å¢ƒ                   â”‚
â”‚  â””â”€ å·¥ä½œç›®å½•ï¼šä¸´æ—¶ç›®å½•éš”ç¦»                          â”‚
â”‚                                                      â”‚
â”‚  åº”ç”¨å±‚                                              â”‚
â”‚  â”œâ”€ å—-ç¯å¢ƒå…³è”ï¼šæ¯ä¸ªå—é€‰æ‹©ç¯å¢ƒ                     â”‚
â”‚  â”œâ”€ æ‰§è¡Œå™¨ï¼šæ ¹æ®ç¯å¢ƒè°ƒç”¨å¯¹åº” Python                 â”‚
â”‚  â””â”€ ç»“æœéš”ç¦»ï¼šæ¯æ¬¡æ‰§è¡Œç‹¬ç«‹è¾“å‡º                      â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- âœ… **å®Œå…¨éš”ç¦»**ï¼šç›®å½•ã€è¿›ç¨‹ã€æ•°æ®ä¸‰å±‚éš”ç¦»
- âœ… **çµæ´»é…ç½®**ï¼šå—çº§åˆ«çš„ç¯å¢ƒé€‰æ‹©
- âœ… **æ˜“äºç®¡ç†**ï¼šWeb ç•Œé¢å¯è§†åŒ–ç®¡ç†
- âœ… **å®‰å…¨å¯é **ï¼šæƒé™æ§åˆ¶ã€èµ„æºé™åˆ¶
- âœ… **æ€§èƒ½ä¼˜åŒ–**ï¼šç¼“å­˜ã€è¿›ç¨‹å¤ç”¨
- âœ… **ä¾¿äºè°ƒè¯•**ï¼šå®Œæ•´çš„æ—¥å¿—è¿½è¸ª

---

## é™„å½•

### A. Python è¿è¡Œæ—¶ä¸‹è½½åœ°å€

#### Windows

```
Python 3.9.7 (åµŒå…¥å¼ç‰ˆæœ¬):
  å®˜æ–¹: https://www.python.org/ftp/python/3.9.7/python-3.9.7-embed-amd64.zip
  æ·˜å®: https://registry.npmmirror.com/binary.html?path=python/3.9.7/

Python 3.11.7:
  å®˜æ–¹: https://www.python.org/ftp/python/3.11.7/python-3.11.7-embed-amd64.zip
```

#### Linux

```
Python æºä»£ç :
  https://www.python.org/ftp/python/3.9.7/Python-3.9.7.tgz

ç¼–è¯‘æ–¹æ³•:
  ./configure --prefix=/opt/python39
  make
  make install
```

### B. pip ä¸‹è½½åœ°å€

```
PyPI å®˜æ–¹:
  https://pypi.org/project/pip/#files
  â†’ ä¸‹è½½ pip-24.0-py3-none-any.whl

æ¸…åé•œåƒ:
  https://pypi.tuna.tsinghua.edu.cn/simple/pip/
```

### C. å¸¸ç”¨åŒ…ä¸‹è½½åœ°å€

| åŒ…å | PyPI å®˜æ–¹ | æ¸…åé•œåƒ |
|------|-----------|----------|
| requests | https://pypi.org/project/requests/#files | https://pypi.tuna.tsinghua.edu.cn/simple/requests/ |
| numpy | https://pypi.org/project/numpy/#files | https://pypi.tuna.tsinghua.edu.cn/simple/numpy/ |
| pandas | https://pypi.org/project/pandas/#files | https://pypi.tuna.tsinghua.edu.cn/simple/pandas/ |
| openpyxl | https://pypi.org/project/openpyxl/#files | https://pypi.tuna.tsinghua.edu.cn/simple/openpyxl/ |

### D. å¿«æ·é”®å’Œæ“ä½œæŠ€å·§

```
ç¯å¢ƒåˆ—è¡¨é¡µé¢:
  â€¢ åŒå‡»ç¯å¢ƒåç§° â†’ å¿«é€Ÿç¼–è¾‘
  â€¢ Ctrl + F â†’ æœç´¢ç¯å¢ƒ

åŒ…ç®¡ç†å¼¹çª—:
  â€¢ Enter â†’ ç¡®è®¤å®‰è£…
  â€¢ Esc â†’ å…³é—­å¼¹çª—

æ‰¹é‡æ“ä½œ:
  â€¢ æ‰¹é‡ä¸Šä¼ åŒ…ï¼šå¯ä»¥è¿ç»­é€‰æ‹©å¤šä¸ª whl æ–‡ä»¶
  â€¢ æ‰¹é‡å®‰è£…ï¼šä½¿ç”¨ requirements.txt
```

### E. API ç«¯ç‚¹å‚è€ƒ

```
ç¯å¢ƒç®¡ç†:
  GET    /api/python-env/page           # åˆ†é¡µæŸ¥è¯¢
  GET    /api/python-env/{id}           # è·å–è¯¦æƒ…
  POST   /api/python-env                # åˆ›å»ºç¯å¢ƒ
  PUT    /api/python-env                # æ›´æ–°ç¯å¢ƒ
  DELETE /api/python-env/{id}           # åˆ é™¤ç¯å¢ƒ
  POST   /api/python-env/{id}/default   # è®¾ä¸ºé»˜è®¤

åŒ…ç®¡ç†:
  POST   /api/python-env/{id}/install   # åœ¨çº¿å®‰è£…åŒ…
  POST   /api/python-env/{id}/uninstall # å¸è½½åŒ…
  POST   /api/python-env/{id}/upload    # ä¸Šä¼ ç¦»çº¿åŒ…
  GET    /api/python-env/{id}/packages  # æŸ¥çœ‹å·²å®‰è£…åŒ…

è¿è¡Œæ—¶ç®¡ç†:
  POST   /api/python-env/{id}/init      # åˆå§‹åŒ–ç›®å½•
  POST   /api/python-env/{id}/runtime   # ä¸Šä¼ è¿è¡Œæ—¶
  POST   /api/python-env/{id}/detect    # æ£€æµ‹Pythonè·¯å¾„
```

---

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-01-21)

**åˆå§‹ç‰ˆæœ¬åŠŸèƒ½**ï¼š
- âœ… å¤šç¯å¢ƒç®¡ç†
- âœ… åœ¨çº¿/ç¦»çº¿åŒ…å®‰è£…
- âœ… Python è¿è¡Œæ—¶ä¸Šä¼ 
- âœ… è‡ªåŠ¨æ£€æµ‹ Python è·¯å¾„
- âœ… requirements.txt å¯¼å…¥å¯¼å‡º
- âœ… ä¾èµ–ç¼ºå¤±æ™ºèƒ½æç¤º
- âœ… åŒ…å†²çªæ£€æµ‹
- âœ… å®‰è£…æ—¥å¿—å®æ—¶æ˜¾ç¤º

---

## æ”¯æŒä¸åé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»ï¼š

- ğŸ“§ Email: support@blockflow.com
- ğŸ“ Issue: https://github.com/blockflow/issues
- ğŸ“– æ–‡æ¡£: https://docs.blockflow.com

---

**BlockFlow Python ç¯å¢ƒç®¡ç†ç³»ç»Ÿ - è®©ä¾èµ–ç®¡ç†æ›´ç®€å•** ğŸš€
